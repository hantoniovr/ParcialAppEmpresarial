<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalle resultado STAI</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .detail-box {
            max-width: 700px;
            margin: 40px auto;
            background: #24242a;
            padding: 25px 30px;
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: 0 0 25px rgba(0,0,0,0.3);
        }
        .detail-title { color: #fff; font-size: 24px; margin-bottom: 5px; }
        .detail-subtitle { color: #b0b0b7; font-size: 14px; margin-bottom: 20px; }
        .detail-item { font-size: 16px; margin: 8px 0; color: #eaeaea; }
        .detail-item strong { color: #ffffff; }
        .interpretacion-box {
            margin-top: 18px; padding: 12px 14px; border-radius: 8px;
            border: 1px solid #3a3a40; background: #1c1c22; color: #e5e5e5;
            white-space: pre-wrap;
        }
        .badge {
            display: inline-block; padding: 4px 8px; border-radius: 999px;
            font-size: 12px; background: #333; color: #ddd;
        }
        .badge-success { background: #2f855a; }
        .badge-warning { background: #b7791f; }
        .badge-muted { background: #4a5568; }
        .detail-actions { margin-top: 20px; display: flex; gap: 16px; }
    </style>
</head>
<body>

<div class="layout-center">

    <div class="admin-breadcrumb">Usuario · Detalle STAI</div>

    <div class="detail-box">

        <h2 class="detail-title">Detalle del resultado STAI</h2>
        <p class="detail-subtitle">Consulta la información detallada e interpretación del resultado.</p>

        <p class="detail-item">
            <strong>Usuario:</strong> <span th:text="${username}"></span>
        </p>

        <p class="detail-item">
            <strong>Fecha:</strong>
            <span th:text="${#temporals.format(resultado.fecha, 'yyyy-MM-dd HH:mm')}"></span>
        </p>

        <p class="detail-item">
            <strong>Puntaje Estado:</strong> <span th:text="${resultado.puntajeEstado}"></span>
        </p>

        <p class="detail-item">
            <strong>Puntaje Rasgo:</strong> <span th:text="${resultado.puntajeRasgo}"></span>
        </p>

        <p class="detail-item">
            <strong>Estado de la solicitud:</strong>

            <span th:switch="
                ${resultado.interpretacion != null and !#strings.isEmpty(resultado.interpretacion)
                    ? 'CON_INTERPRETACION'
                    : (resultado.estadoSolicitudInterpretacion != null
                        ? resultado.estadoSolicitudInterpretacion.name()
                        : 'NO_REALIZADA')}
            ">
                <span th:case="'CON_INTERPRETACION'" class="badge badge-success">COMPLETADA</span>
                <span th:case="'PENDIENTE'" class="badge badge-warning">PENDIENTE</span>
                <span th:case="'COMPLETADA'" class="badge badge-success">COMPLETADA</span>
                <span th:case="*" class="badge badge-muted">NO REALIZADA</span>
            </span>
        </p>

        <h3 class="detail-item" style="margin-top:18px;">Interpretación</h3>

        <div class="interpretacion-box"
             th:if="${resultado.interpretacion != null and !#strings.isEmpty(resultado.interpretacion)}"
             th:text="${resultado.interpretacion}">
        </div>

        <div class="interpretacion-box"
             th:if="${resultado.interpretacion == null or #strings.isEmpty(resultado.interpretacion)}">
            Aún no se ha registrado una interpretación para este resultado.
        </div>

        <div class="detail-actions">
            <a th:href="@{/me/stai}" class="btn btn-sm">Volver al historial</a>
            <a th:href="@{/me}" class="btn btn-sm">Volver a mi panel</a>
        </div>

    </div>

</div>

</body>
</html>
